{% extends "base.html" %}

{% block content %}
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; margin-bottom: 4rem;">
    <!-- Image -->
    <div class="glass-panel" style="padding: 1rem; display: flex; align-items: center; justify-content: center;">
        {% if product.imagenes %}
        <img src="{{ product.imagenes[0] }}" alt="{{ product.nombre }}" style="max-width: 100%; border-radius: 8px;">
        {% else %}
        <div
            style="width: 100%; height: 300px; background: #222; display: flex; align-items: center; justify-content: center;">
            Sin Imagen</div>
        {% endif %}
    </div>

    <!-- Details -->
    <div>
        <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem;">{{ product.nombre }}</h1>
        <div style="color: var(--secondary-color); font-size: 1.5rem; font-weight: bold; margin-bottom: 1.5rem;">
            ${{ product.precio / 100 }} {{ product.moneda }}
        </div>

        <div class="glass-panel" style="margin-bottom: 2rem;">
            <p style="line-height: 1.6;">{{ product.descripcion }}</p>
            <div style="margin-top: 1rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                {% for key, value in product.atributos.items() %}
                <span
                    style="background: rgba(255,255,255,0.1); padding: 4px 10px; border-radius: 20px; font-size: 0.9rem;">
                    <strong>{{ key|capitalize }}:</strong> {{ value }}
                </span>
                {% endfor %}
            </div>
        </div>

        <div style="display: flex; gap: 1rem;">
            <a href="/cart/add/{{ product._id }}" class="btn" style="flex: 1; text-align: center;">Agregar al
                Carrito</a>
            <!-- Future: Buy Now -->
        </div>
        <p style="margin-top: 1rem; color: #aaa; font-size: 0.9rem;">Stock disponible: {{ product.stock }}</p>
    </div>
</div>

<!-- Recommendations -->
<section>
    <h2 style="margin-bottom: 1.5rem; border-left: 4px solid var(--accent-color); padding-left: 10px;">Productos
        Similares</h2>
    <div class="product-grid">
        {% for rec in recommendations %}
        <div class="glass-panel product-card">
            {% if rec.imagenes %}
            <img src="{{ rec.imagenes[0] }}" alt="{{ rec.nombre }}" class="product-img">
            {% else %}
            <div class="product-img" style="background: #222;"></div>
            {% endif %}

            <div class="product-title">{{ rec.nombre }}</div>
            <div class="product-price">${{ rec.precio / 100 }}</div>

            <div style="margin-top: auto; display: flex; gap: 0.5rem;">
                <a href="/product/{{ rec._id }}" class="btn btn-secondary"
                    style="flex: 1; text-align: center; font-size: 0.8rem;">Ver</a>
            </div>
        </div>
        {% else %}
        <p style="color: #aaa;">No hay recomendaciones por el momento.</p>
        {% endfor %}
    </div>
</section>
{% endblock %}